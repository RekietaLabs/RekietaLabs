<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cashier POS</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
        }
        #pin-container {
            display: block;
            margin-top: 50px;
        }
        #pin-input {
            font-size: 20px;
            padding: 10px;
            margin-bottom: 10px;
        }
        #login-btn {
            font-size: 18px;
            padding: 10px 20px;
            cursor: pointer;
        }
        #cashier-ui {
            display: none;
            margin-top: 30px;
        }
        .left-side {
            float: left;
            width: 50%;
            padding: 20px;
        }
        .right-side {
            float: right;
            width: 50%;
            padding: 20px;
        }
        .item-btn {
            display: block;
            width: 100px;
            height: 100px;
            margin: 10px auto;
            font-size: 18px;
            border-radius: 10px;
            background-color: #be9f13;
            color: white;
            cursor: pointer;
        }
        #total-display {
            font-size: 24px;
            margin-top: 20px;
        }
        #terminal-select, #send-sale-btn {
            font-size: 18px;
            padding: 10px;
            margin-top: 10px;
        }
    </style>
</head>
<body>

    <!-- PIN Login -->
    <div id="pin-container">
        <input type="password" id="pin-input" placeholder="Enter PIN">
        <button id="login-btn">Login</button>
    </div>

    <!-- Cashier UI (Hidden until PIN is entered) -->
    <div id="cashier-ui">
        <div class="left-side">
            <button class="item-btn" onclick="addItem('Item A', 5.00)">Item A - $5</button>
            <button class="item-btn" onclick="addItem('Item B', 10.00)">Item B - $10</button>
            <button class="item-btn" onclick="addItem('Item C', 7.50)">Item C - $7.50</button>
        </div>
        <div class="right-side">
            <h3>Items:</h3>
            <ul id="item-list"></ul>
            <h2 id="total-display">Total: $0.00</h2>

            <label for="terminal-select">Select Terminal:</label>
            <select id="terminal-select">
                <option value="1">Terminal 1</option>
                <option value="2">Terminal 2</option>
                <option value="3">Terminal 3</option>
                <option value="4">Terminal 4</option>
                <option value="5">Terminal 5</option>
            </select>

            <button id="send-sale-btn">Send Sale</button>
            <h3 id="transaction-status"></h3>
        </div>
    </div>

    <script>
        let totalAmount = 0;
        let selectedTerminal = "1"; // Default terminal 1

        // PIN login
        document.getElementById("login-btn").addEventListener("click", function () {
            let pin = document.getElementById("pin-input").value;
            if (pin === "1234") { // Replace with real PIN checking
                document.getElementById("pin-container").style.display = "none";
                document.getElementById("cashier-ui").style.display = "block";
            } else {
                alert("Incorrect PIN");
            }
        });

        // Add item function
        function addItem(name, price) {
            let listItem = document.createElement("li");
            listItem.textContent = `${name} - $${price.toFixed(2)}`;
            document.getElementById("item-list").appendChild(listItem);

            totalAmount += price;
            document.getElementById("total-display").textContent = `Total: $${totalAmount.toFixed(2)}`;
        }

        // Update selected terminal
        document.getElementById("terminal-select").addEventListener("change", function () {
            selectedTerminal = this.value;
        });

        // Send sale to terminal
        document.getElementById("send-sale-btn").addEventListener("click", function () {
            let terminalWindow = window.open(`https://rekietalabs.com/Terminal${selectedTerminal}`, "_blank");
            
            setTimeout(() => {
                terminalWindow.postMessage(`sale:${totalAmount.toFixed(2)}`, "*");
            }, 1000);
        });

        // Listen for transaction result from terminal
        window.addEventListener("message", function (event) {
            if (event.data.startsWith("result:")) {
                let result = event.data.split(":")[1];
                document.getElementById("transaction-status").textContent = `Transaction: ${result}`;
            } else if (event.data.startsWith("card:")) {
                let cardInfo = event.data.split(":")[1];
                document.getElementById("transaction-status").textContent += `\nCard Info: ${cardInfo}`;
            }
        });
    </script>

</body>
</html>
